2025-07-25 23:16:39,275 [INFO] Starting blockchain_module.py
2025-07-25 23:16:39,275 [INFO] Starting parse_bgpd_json
2025-07-25 23:16:39,275 [DEBUG] Current script directory: /home/anik/code/BGP_Announcement_Recorder/nodes/rpki_nodes/as01
2025-07-25 23:16:39,275 [DEBUG] Resolved shared_data directory: /home/anik/code/BGP_Announcement_Recorder/shared_data
2025-07-25 23:16:39,275 [DEBUG] Full path to bgpd.json: /home/anik/code/BGP_Announcement_Recorder/shared_data/bgpd.json
2025-07-25 23:16:39,275 [DEBUG] Full path to trust_state.json: /home/anik/code/BGP_Announcement_Recorder/shared_data/trust_state.json
2025-07-25 23:16:39,275 [DEBUG] Full path to blockchain.json: /home/anik/code/BGP_Announcement_Recorder/shared_data/blockchain.json
2025-07-25 23:16:39,275 [INFO] Checking for input files
2025-07-25 23:16:39,275 [ERROR] bgpd.json not found at /home/anik/code/BGP_Announcement_Recorder/shared_data/bgpd.json
2025-07-25 23:16:39,275 [INFO] Finished blockchain_module.py
2025-07-25 23:17:10,784 [INFO] Starting blockchain_module.py
2025-07-25 23:17:10,785 [INFO] Starting parse_bgpd_json
2025-07-25 23:17:10,785 [DEBUG] Current script directory: /home/anik/code/BGP_Announcement_Recorder/nodes/rpki_nodes/as01
2025-07-25 23:17:10,785 [DEBUG] Resolved shared_data directory: /home/anik/code/BGP_Announcement_Recorder/shared_data
2025-07-25 23:17:10,785 [DEBUG] Full path to bgpd.json: /home/anik/code/BGP_Announcement_Recorder/nodes/rpki_nodes/as01/bgpd.json
2025-07-25 23:17:10,785 [DEBUG] Full path to trust_state.json: /home/anik/code/BGP_Announcement_Recorder/shared_data/trust_state.json
2025-07-25 23:17:10,785 [DEBUG] Full path to blockchain.json: /home/anik/code/BGP_Announcement_Recorder/shared_data/blockchain.json
2025-07-25 23:17:10,785 [INFO] Checking for input files
2025-07-25 23:17:10,785 [INFO] Input files found
2025-07-25 23:17:10,785 [INFO] Reading bgpd.json
2025-07-25 23:17:10,785 [DEBUG] bgpd.json content: {'bgp_announcements': [{'sender_asn': 2, 'announced_prefixes': ['203.0.113.0/24'], 'timestamp': '2025-07-24T14:00:00Z'}]}
2025-07-25 23:17:10,785 [INFO] Reading trust_state.json
2025-07-25 23:17:10,785 [DEBUG] trust_state.json content: {'2_203.0.113.0/24': 74, '2_198.51.100.0/24': 79, '4_203.0.113.0/24': 71, '4_198.51.100.0/24': 78, '6_203.0.113.0/24': 75, '6_198.51.100.0/24': 70, '8_192.0.2.0/24': 77, '8_172.16.0.0/16': 72, '10_203.0.113.0/24': 76, '10_198.51.100.0/24': 70, '12_198.51.100.0/24': 80, '12_203.0.113.0/24': 73, '14_192.0.2.0/24': 78, '14_172.16.0.0/16': 74, '16_192.0.2.0/24': 79, '16_172.16.0.0/16': 70, '18_192.0.2.0/24': 75, '18_172.16.0.0/16': 71}
2025-07-25 23:17:10,785 [INFO] Validating bgpd.json structure
2025-07-25 23:17:10,785 [DEBUG] Number of announcements: 1
2025-07-25 23:17:10,785 [INFO] Prompting user for announcement index
2025-07-25 23:17:14,064 [DEBUG] User input index: 1
2025-07-25 23:17:14,064 [DEBUG] Selected announcement: {'sender_asn': 2, 'announced_prefixes': ['203.0.113.0/24'], 'timestamp': '2025-07-24T14:00:00Z'}
2025-07-25 23:17:14,064 [DEBUG] Extracted fields: sender_asn=2, prefixes=['203.0.113.0/24'], timestamp=2025-07-24T14:00:00Z
2025-07-25 23:17:14,064 [DEBUG] Selected IP prefix: 203.0.113.0/24
2025-07-25 23:17:14,064 [DEBUG] Extracted prefix length: 24
2025-07-25 23:17:14,064 [DEBUG] Trust score for sender_asn 2: N/A
2025-07-25 23:17:14,064 [WARNING] No trust score found for sender_asn 2 in announcement 1
2025-07-25 23:17:14,064 [INFO] Generating key pair for signing
2025-07-25 23:17:14,064 [DEBUG] Generating RSA key pair
2025-07-25 23:17:14,118 [DEBUG] RSA key pair generated successfully
2025-07-25 23:17:14,119 [INFO] Checking blockchain.json
2025-07-25 23:17:14,119 [DEBUG] blockchain.json exists at /home/anik/code/BGP_Announcement_Recorder/shared_data/blockchain.json
2025-07-25 23:17:14,119 [DEBUG] blockchain.json content: [{'index': 0, 'timestamp': 1752875442, 'previous_hash': '0000000000000000000000000000000000000000000000000000000000000000', 'proposer': 65001, 'announcements': [{'asn': 65010, 'prefix': '203.0.113.0/24', 'as_path': [65001], 'next_hop': '10.0.0.1', 'timestamp': 1752874471, 'type': 'announce', 'wallet_address': '0xBcd4042DE499D14e55001CcbB24a551F3b954096'}, {'asn': 65010, 'prefix': '203.0.113.0/24', 'as_path': [65011, 65002], 'next_hop': '10.1.1.1', 'timestamp': 1752874526, 'type': 'announce', 'wallet_address': '0xBcd4042DE499D14e55001CcbB24a551F3b954096'}], 'hash': 'bbe757eb14cf82cd2d0f68b164425b9516a145b81f6203ad08e48d16eb712e3d'}]
2025-07-25 23:17:14,119 [ERROR] Unexpected error: 'list' object has no attribute 'get'
2025-07-25 23:17:14,119 [INFO] Finished blockchain_module.py
