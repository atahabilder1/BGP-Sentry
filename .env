# =============================================================================
# BGP-Sentry Configuration — Tunable Hyperparameters
# =============================================================================
# All simulation parameters in one place for easy experimentation.
# Modify values here and re-run `python3 main_experiment.py --dataset <name>`
# without changing any source code.
#
# Units are noted in brackets: [s]=seconds, [coins]=BGPCOIN tokens,
# [score]=trust-score points (0-100).
# =============================================================================

# ─────────────────────────────────────────────────────────────────────────────
# 1. CONSENSUS
# ─────────────────────────────────────────────────────────────────────────────
# Minimum number of RPKI peer signatures required to commit a block.
# Higher = more secure but slower. Formula: max(MIN, min(N/3+1, CAP))
# where N = number of RPKI nodes in the network.
CONSENSUS_MIN_SIGNATURES=3
CONSENSUS_CAP_SIGNATURES=5

# ─────────────────────────────────────────────────────────────────────────────
# 2. P2P NETWORK & TRANSACTION POOL
# ─────────────────────────────────────────────────────────────────────────────
# How long to wait for consensus votes before giving up [s].
# Regular = normal BGP updates; Attack = attack proposals (higher priority).
P2P_REGULAR_TIMEOUT=30
P2P_ATTACK_TIMEOUT=60

# Max peers to broadcast a new transaction to (caps O(N²) message volume).
P2P_MAX_BROADCAST_PEERS=10

# Base port for P2P sockets (only used when use_memory_bus=False).
# Final port = BASE_PORT + AS number.
P2P_BASE_PORT=8000

# ─────────────────────────────────────────────────────────────────────────────
# 3. DEDUPLICATION & SAMPLING
# ─────────────────────────────────────────────────────────────────────────────
# RPKI nodes: skip writing the same (prefix, origin) to blockchain if
# it was written less than this many seconds ago [s].
RPKI_DEDUP_WINDOW=3600

# Non-RPKI nodes: throttle duplicate observations — skip if the same
# (prefix, origin) was processed less than this many seconds ago [s].
NONRPKI_DEDUP_WINDOW=10

# Sampling window for the P2P transaction pool: ignore duplicate
# announcements within this period [s]. Should match RPKI_DEDUP_WINDOW.
SAMPLING_WINDOW_SECONDS=3600

# ─────────────────────────────────────────────────────────────────────────────
# 4. KNOWLEDGE BASE (per-node observation memory)
# ─────────────────────────────────────────────────────────────────────────────
# How long each node remembers BGP observations [s].
# Used for knowledge-based voting (checking if an announcement was seen before).
KNOWLEDGE_WINDOW_SECONDS=480

# How often to garbage-collect old observations from the knowledge base [s].
KNOWLEDGE_CLEANUP_INTERVAL=60

# ─────────────────────────────────────────────────────────────────────────────
# 5. BUFFER CAPACITY LIMITS
# ─────────────────────────────────────────────────────────────────────────────
# Maximum entries in the pending-votes dict before oldest are force-timed-out.
PENDING_VOTES_MAX_CAPACITY=5000

# Maximum entries in committed_transactions tracker before oldest are evicted.
COMMITTED_TX_MAX_SIZE=50000

# How often to garbage-collect old committed transaction IDs [s].
COMMITTED_TX_CLEANUP_INTERVAL=300

# Maximum observations in the knowledge base before oldest are trimmed.
KNOWLEDGE_BASE_MAX_SIZE=50000

# Maximum entries in the last-seen sampling cache before oldest are evicted.
LAST_SEEN_CACHE_MAX_SIZE=100000

# ─────────────────────────────────────────────────────────────────────────────
# 6. ATTACK DETECTION — ROUTE FLAPPING
# ─────────────────────────────────────────────────────────────────────────────
# Sliding window: count unique state changes for (prefix, origin) [s].
FLAP_WINDOW_SECONDS=60

# If more than this many unique state changes happen within the window,
# classify as ROUTE_FLAPPING. Higher = fewer false positives.
FLAP_THRESHOLD=5

# Two observations arriving within this interval [s] are treated as the
# same event (prevents multi-node observation inflation).
FLAP_DEDUP_SECONDS=2

# ─────────────────────────────────────────────────────────────────────────────
# 7. BGPCOIN TOKEN ECONOMY
# ─────────────────────────────────────────────────────────────────────────────
# Total token supply. Treasury starts with this amount; rewards drain it.
BGPCOIN_TOTAL_SUPPLY=10000000

# Reward amounts [coins]
BGPCOIN_REWARD_BLOCK_COMMIT=10
BGPCOIN_REWARD_VOTE_APPROVE=1
BGPCOIN_REWARD_FIRST_COMMIT_BONUS=5
BGPCOIN_REWARD_ATTACK_DETECTION=100
BGPCOIN_REWARD_DAILY_MONITORING=10

# Penalty amounts [coins] (applied as negative values)
BGPCOIN_PENALTY_FALSE_REJECT=2
BGPCOIN_PENALTY_FALSE_APPROVE=5
BGPCOIN_PENALTY_MISSED_PARTICIPATION=1

# Multiplier ranges: (min, max) — applied to base rewards based on node history.
# accuracy: historical correctness; participation: consistency; quality: evidence.
BGPCOIN_MULTIPLIER_ACCURACY_MIN=0.5
BGPCOIN_MULTIPLIER_ACCURACY_MAX=1.5
BGPCOIN_MULTIPLIER_PARTICIPATION_MIN=0.8
BGPCOIN_MULTIPLIER_PARTICIPATION_MAX=1.2
BGPCOIN_MULTIPLIER_QUALITY_MIN=0.9
BGPCOIN_MULTIPLIER_QUALITY_MAX=1.3

# ─────────────────────────────────────────────────────────────────────────────
# 8. NON-RPKI TRUST RATING SYSTEM
# ─────────────────────────────────────────────────────────────────────────────
# Score range and initial value [score points, 0-100].
RATING_INITIAL_SCORE=50
RATING_MIN_SCORE=0
RATING_MAX_SCORE=100

# Penalties per attack type [score points] (negative = deducted)
RATING_PENALTY_PREFIX_HIJACK=-20
RATING_PENALTY_SUBPREFIX_HIJACK=-18
RATING_PENALTY_BOGON_INJECTION=-25
RATING_PENALTY_ROUTE_FLAPPING=-10
RATING_PENALTY_ROUTE_LEAK=-15
RATING_PENALTY_REPEATED_ATTACK=-30
RATING_PENALTY_PERSISTENT_ATTACKER=-50

# Rewards [score points] (positive = added)
RATING_REWARD_MONTHLY_GOOD_BEHAVIOR=5
RATING_REWARD_FALSE_ACCUSATION_CLEARED=2
RATING_REWARD_PER_100_LEGITIMATE=1
RATING_REWARD_HIGHLY_TRUSTED_BONUS=10

# Trust classification thresholds [score points]
RATING_THRESHOLD_HIGHLY_TRUSTED=90
RATING_THRESHOLD_TRUSTED=70
RATING_THRESHOLD_NEUTRAL=50
RATING_THRESHOLD_SUSPICIOUS=30

# ─────────────────────────────────────────────────────────────────────────────
# 9. ATTACK CONSENSUS (voting on detected attacks)
# ─────────────────────────────────────────────────────────────────────────────
# Minimum votes needed to finalize an attack verdict.
ATTACK_CONSENSUS_MIN_VOTES=3

# Rewards/penalties for attack consensus participation [coins].
ATTACK_CONSENSUS_REWARD_DETECTION=10
ATTACK_CONSENSUS_REWARD_CORRECT_VOTE=2
ATTACK_CONSENSUS_PENALTY_FALSE_ACCUSATION=-20
